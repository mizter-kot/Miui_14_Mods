# Настройки тайлов в центре управления: цвета, закругления, обводка

## MiuiSystemUIPlugin.apk

### Класс Lmiui/systemui/controlcenter/qs/tileview/BigTileIconView;

В методе

```smali
.method private final updateBackground()V
```

найти строку

```smali
invoke-virtual {p0, v0}, Lmiui/systemui/controlcenter/qs/tileview/BigTileView;->setBackground(Landroid/graphics/drawable/Drawable;)V
```

и перед ней добавить

```smali
invoke-virtual {p0}, Lmiui/systemui/controlcenter/qs/tileview/BigTileView;->getContext()Landroid/content/Context;

move-result-object v2

invoke-static {v2}, LMyControlCenterUtils;->getMyNewCcSettingsEnabled(Landroid/content/Context;)Z

move-result v1

if-eqz v1, :set_background

iget v1, p0, Lmiui/systemui/controlcenter/qs/tileview/BigTileView;->mState:I

invoke-static {v2, v1}, LMyControlCenterUtils;->getCustomBgDrawableFromStateForBigTile(Landroid/content/Context;I)Landroid/graphics/drawable/Drawable;

move-result-object v0

:set_background
```

## Settings.apk

### res/xml/*.xml

Добавить

```xml
<PreferenceCategory android:title="Дизайн тайлов">
    <XMiuiColorPickerPreference 
        android:title="Цвет включенного тайла" 
        android:key="my_active_big_tile_bg_color"  
        android:defaultValue="#ff3d84ff"
        android:dependency="my_new_cc_settings_enabled"
        alphaSlider="true" 
        hexValue="true" />
    <XMiuiColorPickerPreference 
        android:title="Цвет выключенного тайла" 
        android:key="my_disabled_big_tile_bg_color"  
        android:defaultValue="#26ffffff"
        android:dependency="my_new_cc_settings_enabled"
        alphaSlider="true" 
        hexValue="true" />
    <XMiuiColorPickerPreference 
        android:title="Цвет недоступного тайла" 
        android:key="my_unavailable_big_tile_bg_color"  
        android:defaultValue="#26ffffff"
        android:dependency="my_new_cc_settings_enabled"
        alphaSlider="true" 
        hexValue="true" />
    <XMiuiCheckBoxPreference
        android:title="Градиент тайлов"
        android:key="my_big_tile_bg_gradient_enabled"
        android:defaultValue="false"
        android:summaryOn="Включен"
        android:summaryOff="Выключен"
        android:dependency="my_new_cc_settings_enabled" />
    <XMiuiColorPickerPreference 
        android:title="Первый цвет градиента включенного тайла" 
        android:key="my_active_big_tile_bg_gradient_first_color"  
        android:defaultValue="#ff3d84ff" 
        android:dependency="my_big_tile_bg_gradient_enabled"
        alphaSlider="true" 
        hexValue="true" />
    <XMiuiColorPickerPreference 
        android:title="Второй цвет градиента включенного тайла" 
        android:key="my_active_big_tile_bg_gradient_second_color"  
        android:defaultValue="#ff3d84ff" 
        android:dependency="my_big_tile_bg_gradient_enabled"
        alphaSlider="true" 
        hexValue="true" />
    <XMiuiColorPickerPreference 
        android:title="Первый цвет градиента выключенного тайла" 
        android:key="my_disabled_big_tile_bg_gradient_first_color"  
        android:defaultValue="#26ffffff" 
        android:dependency="my_big_tile_bg_gradient_enabled"
        alphaSlider="true" 
        hexValue="true" />
    <XMiuiColorPickerPreference 
        android:title="Второй цвет градиента выключенного тайла" 
        android:key="my_disabled_big_tile_bg_gradient_second_color"  
        android:defaultValue="#26ffffff" 
        android:dependency="my_big_tile_bg_gradient_enabled"
        alphaSlider="true" 
        hexValue="true" />
    <XMiuiColorPickerPreference 
        android:title="Первый цвет градиента недоступного тайла" 
        android:key="my_unavailable_big_tile_stroke_width"  
        android:defaultValue="#26ffffff" 
        android:dependency="my_big_tile_bg_gradient_enabled"
        alphaSlider="true" 
        hexValue="true" />
    <XMiuiColorPickerPreference 
        android:title="Второй цвет градиента недоступного тайла" 
        android:key="my_unavailable_big_tile_stroke_color"  
        android:defaultValue="#26ffffff" 
        android:dependency="my_big_tile_bg_gradient_enabled"
        alphaSlider="true" 
        hexValue="true" />
    <XMiuiListPreference 
        android:entries="@array/gradient_orientation_entries"
        android:entryValues="@array/gradient_orientation_values"
        android:title="Ориентация градиента включенного тайла"
        android:key="my_active_big_tile_gradient_orientation"
        android:summary="%s"
        android:defaultValue="LEFT_RIGHT" 
        android:dependency="my_big_tile_bg_gradient_enabled" />
    <XMiuiListPreference 
        android:entries="@array/gradient_orientation_entries"
        android:entryValues="@array/gradient_orientation_values"
        android:title="Ориентация градиента выключенного тайла"
        android:key="my_disabled_big_tile_gradient_orientation"
        android:summary="%s"
        android:defaultValue="LEFT_RIGHT"
        android:dependency="my_big_tile_bg_gradient_enabled" />
    <XMiuiListPreference 
        android:entries="@array/gradient_orientation_entries"
        android:entryValues="@array/gradient_orientation_values"
        android:title="Ориентация градиента недоступного тайла"
        android:key="my_unavailable_big_tile_gradient_orientation"
        android:summary="%s"
        android:defaultValue="LEFT_RIGHT"
        android:dependency="my_big_tile_bg_gradient_enabled" />
    <XMiuiSeekBarPreference 
        android:layout="@layout/miuix_seekbar" 
        android:title="Ширина обводки включенного тайла" 
        android:key="my_active_big_tile_stroke_width" 
        android:defaultValue="0"
        android:dependency="my_new_cc_settings_enabled"
        enableSummary="true" 
        min="0" max="20" />
    <XMiuiSeekBarPreference 
        android:layout="@layout/miuix_seekbar" 
        android:title="Ширина обводки выключенного тайла" 
        android:key="my_disabled_big_tile_stroke_width" 
        android:defaultValue="0"
        android:dependency="my_new_cc_settings_enabled"
        enableSummary="true" 
        min="0" max="20" />
    <XMiuiSeekBarPreference 
        android:layout="@layout/miuix_seekbar" 
        android:title="Ширина обводки недоступного тайла" 
        android:key="my_unavailable_big_tile_stroke_width" 
        android:defaultValue="0"
        android:dependency="my_new_cc_settings_enabled"
        enableSummary="true" 
        min="0" max="20" />
    <XMiuiColorPickerPreference 
        android:title="Цвет обводки включенного тайла" 
        android:key="my_active_big_tile_stroke_color"  
        android:defaultValue="#ff3d84ff"
        android:dependency="my_new_cc_settings_enabled"
        alphaSlider="true" 
        hexValue="true" />
    <XMiuiColorPickerPreference 
        android:title="Цвет обводки выключенного тайла" 
        android:key="my_disabled_big_tile_stroke_color"  
        android:defaultValue="#26ffffff"
        android:dependency="my_new_cc_settings_enabled"
        alphaSlider="true" 
        hexValue="true" />
    <XMiuiColorPickerPreference 
        android:title="Цвет обводки недоступного тайла" 
        android:key="my_unavailable_big_tile_stroke_color"  
        android:defaultValue="#26ffffff"
        android:dependency="my_new_cc_settings_enabled"
        alphaSlider="true" 
        hexValue="true" />
    <XMiuiSeekBarPreference 
        android:layout="@layout/miuix_seekbar" 
        android:title="Радиус закругления углов тайла" 
        android:key="my_big_tile_corner_radius" 
        android:defaultValue="40"
        android:dependency="my_new_cc_settings_enabled"
        enableSummary="true" 
        min="0" max="100" />
</PreferenceCategory>
```
